{
  "intraFileMappings" : {
    "matchedElements" : [
 {
      "left" : "private Path tokenPath;",
      "right" : "private Path tokenPath;",
      "info" : "FieldDeclaration[1812-1835]:FieldDeclaration[1812-1835]"
    }, {
      "left" : "public static final String HCAT_SERVICE = \"hcat\";",
      "right" : "public static final String HCAT_SERVICE = \"hcat\";",
      "info" : "FieldDeclaration[1838-1887]:FieldDeclaration[1838-1887]"
    }, {
      "left" : "private final boolean isEnabled;",
      "right" : "private final boolean isEnabled;",
      "info" : "FieldDeclaration[1890-1922]:FieldDeclaration[1890-1922]"
    }, {
      "left" : "private String user;",
      "right" : "private String user;",
      "info" : "FieldDeclaration[1925-1945]:FieldDeclaration[1925-1945]"
    }, {
      "left" : "public SecureProxySupport()",
      "right" : "public SecureProxySupport()",
      "info" : "MethodDeclaration[1949-2040]:MethodDeclaration[1949-2040]"
    }, {
      "left" : "private static final Log LOG = LogFactory.getLog(SecureProxySupport.class);",
      "right" : "private static final Log LOG = LogFactory.getLog(SecureProxySupport.class);",
      "info" : "FieldDeclaration[2044-2119]:FieldDeclaration[2044-2119]"
    }, {
      "left" : "public Path getTokenPath()",
      "right" : "public Path getTokenPath()",
      "info" : "MethodDeclaration[2123-2235]:MethodDeclaration[2123-2235]"
    }, {
      "left" : "public String getHcatServiceStr()",
      "right" : "public String getHcatServiceStr()",
      "info" : "MethodDeclaration[2239-2349]:MethodDeclaration[2239-2349]"
    }, {
      "left" : "public void close()",
      "right" : "public void close()",
      "info" : "MethodDeclaration[3118-3271]:MethodDeclaration[3211-3364]"
    }, {
      "left" : "public void addEnv(Map<String, String> env)",
      "right" : "public void addEnv(Map<String, String> env)",
      "info" : "MethodDeclaration[3275-3500]:MethodDeclaration[3368-3593]"
    }, {
      "left" : "public void addArgs(List<String> args)",
      "right" : "public void addArgs(List<String> args)",
      "info" : "MethodDeclaration[3504-3767]:MethodDeclaration[3597-3860]"
    }, {
      "left" : "TokenWrapper",
      "right" : "TokenWrapper",
      "info" : "TypeDeclaration[3771-3815]:TypeDeclaration[3864-3908]"
    }, {
      "left" : "Token<?> token;",
      "right" : "Token<?> token;",
      "info" : "FieldDeclaration[3796-3811]:FieldDeclaration[3889-3904]"
    }, {
      "left" : "private Token<?> getFSDelegationToken(String user,\n                      final Configuration conf)\n    throws IOException, InterruptedException",
      "right" : "private Token<?> getFSDelegationToken(String user,\n                      final Configuration conf)\n    throws IOException, InterruptedException",
      "info" : "MethodDeclaration[3819-4570]:MethodDeclaration[3912-4663]"
    }, {
      "left" : "public Object run() throws IOException",
      "right" : "public Object run() throws IOException",
      "info" : "MethodDeclaration[4243-4530]:MethodDeclaration[4336-4623]"
    }, {
      "left" : "private void writeProxyDelegationTokens(final Token<?> fsToken,\n                      final Token<?> msToken,\n                      final Configuration conf,\n                      String user,\n                      final Path tokenPath)\n    throws IOException, InterruptedException",
      "right" : "private void writeProxyDelegationTokens(final Token<?> fsToken,\n                      final Token<?> msToken,\n                      final Configuration conf,\n                      String user,\n                      final Path tokenPath)\n    throws IOException, InterruptedException",
      "info" : "MethodDeclaration[4574-5374]:MethodDeclaration[4667-5467]"
    }, {
      "left" : "public Object run() throws IOException",
      "right" : "public Object run() throws IOException",
      "info" : "MethodDeclaration[5085-5361]:MethodDeclaration[5178-5454]"
    }, {
      "left" : "public String run()\n        throws IOException, MetaException, TException",
      "right" : "public String run()\n        throws IOException, MetaException, TException",
      "info" : "MethodDeclaration[5904-6083]:MethodDeclaration[5928-6107]"
    } ],
    "mappings" : [
 {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[1949-1955]:Modifier[1949-1955]"
    }, {
      "left" : "SecureProxySupport",
      "right" : "SecureProxySupport",
      "info" : "SimpleName[1956-1974]:SimpleName[1956-1974]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[1977-2040]:Block[1977-2040]"
    }, {
      "left" : "isEnabled = UserGroupInformation.isSecurityEnabled();",
      "right" : "isEnabled = UserGroupInformation.isSecurityEnabled();",
      "info" : "ExpressionStatement[1983-2036]:ExpressionStatement[1983-2036]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[2179-2185]:Modifier[2179-2185]"
    }, {
      "left" : "Path",
      "right" : "Path",
      "info" : "SimpleType[2186-2190]:SimpleType[2186-2190]"
    }, {
      "left" : "getTokenPath",
      "right" : "getTokenPath",
      "info" : "SimpleName[2191-2203]:SimpleName[2191-2203]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[2206-2235]:Block[2206-2235]"
    }, {
      "left" : "return (tokenPath);",
      "right" : "return (tokenPath);",
      "info" : "ReturnStatement[2212-2231]:ReturnStatement[2212-2231]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[2283-2289]:Modifier[2283-2289]"
    }, {
      "left" : "String",
      "right" : "String",
      "info" : "SimpleType[2290-2296]:SimpleType[2290-2296]"
    }, {
      "left" : "getHcatServiceStr",
      "right" : "getHcatServiceStr",
      "info" : "SimpleName[2297-2314]:SimpleName[2297-2314]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[2317-2349]:Block[2317-2349]"
    }, {
      "left" : "return (HCAT_SERVICE);",
      "right" : "return (HCAT_SERVICE);",
      "info" : "ReturnStatement[2323-2345]:ReturnStatement[2323-2345]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[3143-3149]:Modifier[3236-3242]"
    }, {
      "left" : "void",
      "right" : "void",
      "info" : "PrimitiveType[3150-3154]:PrimitiveType[3243-3247]"
    }, {
      "left" : "close",
      "right" : "close",
      "info" : "SimpleName[3155-3160]:SimpleName[3248-3253]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3163-3271]:Block[3256-3364]"
    }, {
      "left" : "if (tokenPath != null)",
      "right" : "if (tokenPath != null)",
      "info" : "IfStatement[3169-3267]:IfStatement[3262-3360]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3192-3267]:Block[3285-3360]"
    }, {
      "left" : "new File(tokenPath.toUri()).delete();",
      "right" : "new File(tokenPath.toUri()).delete();",
      "info" : "ExpressionStatement[3200-3237]:ExpressionStatement[3293-3330]"
    }, {
      "left" : "tokenPath = null;",
      "right" : "tokenPath = null;",
      "info" : "ExpressionStatement[3244-3261]:ExpressionStatement[3337-3354]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[3318-3324]:Modifier[3411-3417]"
    }, {
      "left" : "void",
      "right" : "void",
      "info" : "PrimitiveType[3325-3329]:PrimitiveType[3418-3422]"
    }, {
      "left" : "addEnv",
      "right" : "addEnv",
      "info" : "SimpleName[3330-3336]:SimpleName[3423-3429]"
    }, {
      "left" : "Map<String, String> env",
      "right" : "Map<String, String> env",
      "info" : "SingleVariableDeclaration[3337-3360]:SingleVariableDeclaration[3430-3453]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3362-3500]:Block[3455-3593]"
    }, {
      "left" : "if (isEnabled)",
      "right" : "if (isEnabled)",
      "info" : "IfStatement[3368-3496]:IfStatement[3461-3589]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3383-3496]:Block[3476-3589]"
    }, {
      "left" : "env.put(UserGroupInformation.HADOOP_TOKEN_FILE_LOCATION,\n        getTokenPath().toUri().getPath());",
      "right" : "env.put(UserGroupInformation.HADOOP_TOKEN_FILE_LOCATION,\n        getTokenPath().toUri().getPath());",
      "info" : "ExpressionStatement[3391-3490]:ExpressionStatement[3484-3583]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[3536-3542]:Modifier[3629-3635]"
    }, {
      "left" : "void",
      "right" : "void",
      "info" : "PrimitiveType[3543-3547]:PrimitiveType[3636-3640]"
    }, {
      "left" : "addArgs",
      "right" : "addArgs",
      "info" : "SimpleName[3548-3555]:SimpleName[3641-3648]"
    }, {
      "left" : "List<String> args",
      "right" : "List<String> args",
      "info" : "SingleVariableDeclaration[3556-3573]:SingleVariableDeclaration[3649-3666]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3575-3767]:Block[3668-3860]"
    }, {
      "left" : "if (isEnabled)",
      "right" : "if (isEnabled)",
      "info" : "IfStatement[3581-3763]:IfStatement[3674-3856]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3596-3763]:Block[3689-3856]"
    }, {
      "left" : "args.add(\"-D\");",
      "right" : "args.add(\"-D\");",
      "info" : "ExpressionStatement[3604-3619]:ExpressionStatement[3697-3712]"
    }, {
      "left" : "args.add(\"hive.metastore.token.signature=\" + getHcatServiceStr());",
      "right" : "args.add(\"hive.metastore.token.signature=\" + getHcatServiceStr());",
      "info" : "ExpressionStatement[3626-3692]:ExpressionStatement[3719-3785]"
    }, {
      "left" : "args.add(\"-D\");",
      "right" : "args.add(\"-D\");",
      "info" : "ExpressionStatement[3699-3714]:ExpressionStatement[3792-3807]"
    }, {
      "left" : "args.add(\"proxy.user.name=\" + user);",
      "right" : "args.add(\"proxy.user.name=\" + user);",
      "info" : "ExpressionStatement[3721-3757]:ExpressionStatement[3814-3850]"
    }, {
      "left" : "class",
      "right" : "class",
      "info" : "TYPE_DECLARATION_KIND[3771-3776]:TYPE_DECLARATION_KIND[3864-3869]"
    }, {
      "left" : "TokenWrapper",
      "right" : "TokenWrapper",
      "info" : "SimpleName[3777-3789]:SimpleName[3870-3882]"
    }, {
      "left" : "private",
      "right" : "private",
      "info" : "Modifier[3819-3826]:Modifier[3912-3919]"
    }, {
      "left" : "Token<?>",
      "right" : "Token<?>",
      "info" : "ParameterizedType[3827-3835]:ParameterizedType[3920-3928]"
    }, {
      "left" : "getFSDelegationToken",
      "right" : "getFSDelegationToken",
      "info" : "SimpleName[3836-3856]:SimpleName[3929-3949]"
    }, {
      "left" : "String user",
      "right" : "String user",
      "info" : "SingleVariableDeclaration[3857-3868]:SingleVariableDeclaration[3950-3961]"
    }, {
      "left" : "final Configuration conf",
      "right" : "final Configuration conf",
      "info" : "SingleVariableDeclaration[3892-3916]:SingleVariableDeclaration[3985-4009]"
    }, {
      "left" : "IOException",
      "right" : "IOException",
      "info" : "SimpleType[3929-3940]:SimpleType[4022-4033]"
    }, {
      "left" : "InterruptedException",
      "right" : "InterruptedException",
      "info" : "SimpleType[3942-3962]:SimpleType[4035-4055]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[3963-4570]:Block[4056-4663]"
    }, {
      "left" : "LOG.info(\"user: \" + user + \" loginUser: \" + UserGroupInformation.getLoginUser().getUserName());",
      "right" : "LOG.info(\"user: \" + user + \" loginUser: \" + UserGroupInformation.getLoginUser().getUserName());",
      "info" : "ExpressionStatement[3969-4064]:ExpressionStatement[4062-4157]"
    }, {
      "left" : "final UserGroupInformation ugi = UgiFactory.getUgi(user);",
      "right" : "final UserGroupInformation ugi = UgiFactory.getUgi(user);",
      "info" : "VariableDeclarationStatement[4069-4126]:VariableDeclarationStatement[4162-4219]"
    }, {
      "left" : "final TokenWrapper twrapper = new TokenWrapper();",
      "right" : "final TokenWrapper twrapper = new TokenWrapper();",
      "info" : "VariableDeclarationStatement[4132-4181]:VariableDeclarationStatement[4225-4274]"
    }, {
      "left" : "ugi.doAs(new PrivilegedExceptionAction<Object>() {\n      public Object run() throws IOException {\n        FileSystem fs = FileSystem.get(conf);\n        //todo: according to JavaDoc this seems like private API: addDelegationToken should be used\n        twrapper.token = fs.getDelegationToken(ugi.getShortUserName());\n        return null;\n      }\n    });",
      "right" : "ugi.doAs(new PrivilegedExceptionAction<Object>() {\n      public Object run() throws IOException {\n        FileSystem fs = FileSystem.get(conf);\n        //todo: according to JavaDoc this seems like private API: addDelegationToken should be used\n        twrapper.token = fs.getDelegationToken(ugi.getShortUserName());\n        return null;\n      }\n    });",
      "info" : "ExpressionStatement[4186-4538]:ExpressionStatement[4279-4631]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[4243-4249]:Modifier[4336-4342]"
    }, {
      "left" : "Object",
      "right" : "Object",
      "info" : "SimpleType[4250-4256]:SimpleType[4343-4349]"
    }, {
      "left" : "run",
      "right" : "run",
      "info" : "SimpleName[4257-4260]:SimpleName[4350-4353]"
    }, {
      "left" : "IOException",
      "right" : "IOException",
      "info" : "SimpleType[4270-4281]:SimpleType[4363-4374]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[4282-4530]:Block[4375-4623]"
    }, {
      "left" : "FileSystem fs = FileSystem.get(conf);",
      "right" : "FileSystem fs = FileSystem.get(conf);",
      "info" : "VariableDeclarationStatement[4292-4329]:VariableDeclarationStatement[4385-4422]"
    }, {
      "left" : "twrapper.token = fs.getDelegationToken(ugi.getShortUserName());",
      "right" : "twrapper.token = fs.getDelegationToken(ugi.getShortUserName());",
      "info" : "ExpressionStatement[4438-4501]:ExpressionStatement[4531-4594]"
    }, {
      "left" : "return null;",
      "right" : "return null;",
      "info" : "ReturnStatement[4510-4522]:ReturnStatement[4603-4615]"
    }, {
      "left" : "return twrapper.token;",
      "right" : "return twrapper.token;",
      "info" : "ReturnStatement[4543-4565]:ReturnStatement[4636-4658]"
    }, {
      "left" : "private",
      "right" : "private",
      "info" : "Modifier[4574-4581]:Modifier[4667-4674]"
    }, {
      "left" : "void",
      "right" : "void",
      "info" : "PrimitiveType[4582-4586]:PrimitiveType[4675-4679]"
    }, {
      "left" : "writeProxyDelegationTokens",
      "right" : "writeProxyDelegationTokens",
      "info" : "SimpleName[4587-4613]:SimpleName[4680-4706]"
    }, {
      "left" : "final Token<?> fsToken",
      "right" : "final Token<?> fsToken",
      "info" : "SingleVariableDeclaration[4614-4636]:SingleVariableDeclaration[4707-4729]"
    }, {
      "left" : "final Token<?> msToken",
      "right" : "final Token<?> msToken",
      "info" : "SingleVariableDeclaration[4660-4682]:SingleVariableDeclaration[4753-4775]"
    }, {
      "left" : "final Configuration conf",
      "right" : "final Configuration conf",
      "info" : "SingleVariableDeclaration[4706-4730]:SingleVariableDeclaration[4799-4823]"
    }, {
      "left" : "String user",
      "right" : "String user",
      "info" : "SingleVariableDeclaration[4754-4765]:SingleVariableDeclaration[4847-4858]"
    }, {
      "left" : "final Path tokenPath",
      "right" : "final Path tokenPath",
      "info" : "SingleVariableDeclaration[4789-4809]:SingleVariableDeclaration[4882-4902]"
    }, {
      "left" : "IOException",
      "right" : "IOException",
      "info" : "SimpleType[4822-4833]:SimpleType[4915-4926]"
    }, {
      "left" : "InterruptedException",
      "right" : "InterruptedException",
      "info" : "SimpleType[4835-4855]:SimpleType[4928-4948]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[4856-5374]:Block[4949-5467]"
    }, {
      "left" : "LOG.info(\"user: \" + user + \" loginUser: \" + UserGroupInformation.getLoginUser().getUserName());",
      "right" : "LOG.info(\"user: \" + user + \" loginUser: \" + UserGroupInformation.getLoginUser().getUserName());",
      "info" : "ExpressionStatement[4864-4959]:ExpressionStatement[4957-5052]"
    }, {
      "left" : "final UserGroupInformation ugi = UgiFactory.getUgi(user);",
      "right" : "final UserGroupInformation ugi = UgiFactory.getUgi(user);",
      "info" : "VariableDeclarationStatement[4964-5021]:VariableDeclarationStatement[5057-5114]"
    }, {
      "left" : "ugi.doAs(new PrivilegedExceptionAction<Object>() {\n      public Object run() throws IOException {\n        Credentials cred = new Credentials();\n        cred.addToken(fsToken.getService(), fsToken);\n        cred.addToken(msToken.getService(), msToken);\n        cred.writeTokenStorageFile(tokenPath, conf);\n        return null;\n      }\n    });",
      "right" : "ugi.doAs(new PrivilegedExceptionAction<Object>() {\n      public Object run() throws IOException {\n        Credentials cred = new Credentials();\n        cred.addToken(fsToken.getService(), fsToken);\n        cred.addToken(msToken.getService(), msToken);\n        cred.writeTokenStorageFile(tokenPath, conf);\n        return null;\n      }\n    });",
      "info" : "ExpressionStatement[5028-5369]:ExpressionStatement[5121-5462]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[5085-5091]:Modifier[5178-5184]"
    }, {
      "left" : "Object",
      "right" : "Object",
      "info" : "SimpleType[5092-5098]:SimpleType[5185-5191]"
    }, {
      "left" : "run",
      "right" : "run",
      "info" : "SimpleName[5099-5102]:SimpleName[5192-5195]"
    }, {
      "left" : "IOException",
      "right" : "IOException",
      "info" : "SimpleType[5112-5123]:SimpleType[5205-5216]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[5124-5361]:Block[5217-5454]"
    }, {
      "left" : "Credentials cred = new Credentials();",
      "right" : "Credentials cred = new Credentials();",
      "info" : "VariableDeclarationStatement[5134-5171]:VariableDeclarationStatement[5227-5264]"
    }, {
      "left" : "cred.addToken(fsToken.getService(), fsToken);",
      "right" : "cred.addToken(fsToken.getService(), fsToken);",
      "info" : "ExpressionStatement[5180-5225]:ExpressionStatement[5273-5318]"
    }, {
      "left" : "cred.addToken(msToken.getService(), msToken);",
      "right" : "cred.addToken(msToken.getService(), msToken);",
      "info" : "ExpressionStatement[5234-5279]:ExpressionStatement[5327-5372]"
    }, {
      "left" : "cred.writeTokenStorageFile(tokenPath, conf);",
      "right" : "cred.writeTokenStorageFile(tokenPath, conf);",
      "info" : "ExpressionStatement[5288-5332]:ExpressionStatement[5381-5425]"
    }, {
      "left" : "return null;",
      "right" : "return null;",
      "info" : "ReturnStatement[5341-5353]:ReturnStatement[5434-5446]"
    }, {
      "left" : "public",
      "right" : "public",
      "info" : "Modifier[5904-5910]:Modifier[5928-5934]"
    }, {
      "left" : "String",
      "right" : "String",
      "info" : "SimpleType[5911-5917]:SimpleType[5935-5941]"
    }, {
      "left" : "run",
      "right" : "run",
      "info" : "SimpleName[5918-5921]:SimpleName[5942-5945]"
    }, {
      "left" : "IOException",
      "right" : "IOException",
      "info" : "SimpleType[5939-5950]:SimpleType[5963-5974]"
    }, {
      "left" : "MetaException",
      "right" : "MetaException",
      "info" : "SimpleType[5952-5965]:SimpleType[5976-5989]"
    }, {
      "left" : "TException",
      "right" : "TException",
      "info" : "SimpleType[5967-5977]:SimpleType[5991-6001]"
    }, {
      "left" : "{}",
      "right" : "{}",
      "info" : "Block[5978-6083]:Block[6002-6107]"
    }, {
      "left" : "String u = ugi.getUserName();",
      "right" : "String u = ugi.getUserName();",
      "info" : "VariableDeclarationStatement[5988-6017]:VariableDeclarationStatement[6012-6041]"
    }, {
      "left" : "return client.getDelegationToken(c.getUser(), u);",
      "right" : "return client.getDelegationToken(c.getUser(), u);",
      "info" : "ReturnStatement[6026-6075]:ReturnStatement[6050-6099]"
    } ]
  },
  "interFileMappings" : { }
}